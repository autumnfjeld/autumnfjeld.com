Transcript from https://aws.amazon.com/awstv/watch/9beeb827905/#chapter4

Hello. I am Iman, a cloud support engineer here at the EWS office in Cape town. Today I'm going to show you how to configure an Amazon cloudfront distribution to serve an HTTP S request for an Amazon symbol storage service bucket. I'll also show you the main differences between our website endpoint and a STEP I endpoint in Amazon. S3 and I will show you how to use a custom S SL certificate with your cloudfront distribution.

 Let's get started first, open the AWS Management Console and navigate to cloudfront choose create distribution to see a list of settings that we can modify to configure our CloudFront distribution. You can see information icons present next to each setting. That gives you a description of what the setting is. 
 
 Let's start with origin domain for Amazon history, we see two options to choose from. We can choose the three bucket REST API endpoint from the drop down list or we can enter the S3 Buckets website endpoint manually. 
 
 Let's go over the key differences between a rest APi endpoint and a website endpoint so that you can determine what is best for your use case. The REST API endpoint has benefits in relation to SSL. The REST API endpoint, supports end to end encryption origin, access, identities and the ability to restrict content to private users. However, depending on the use case, you might want your bucket to be made publicly accessible. In comparison, the SITEPOINT doesn't support Ssl, the website. The point does allow for redirect functionality. For example, you can use a website in the point when you want to redirect users from one U to another. Our website endpoint also supports the ability to use a default index object to be served if a user doesn't request a specific object. Note that a website endpoint support is only publicly readable content in your bucket. 
 
 Because the website endpoint supports only HTTP Traffic, I will choose a rest API endpoint to demonstrate an end to end https connection for the origin path. If you want the cloudfront to always request content from a particular directory in the origin, you can enter the directory bus beginning with a forward /. The origin name populates automatically after you select the REST API endpoint from the drop down list, but you can change it if you need to. For origin access. We have three options. The first option is public. If you choose this option, then the necessary bucket must allow public access. 
 
 The second option is O A or origin access control settings. This option restricts access to the bucket to authenticated requests from Cloudfront only. We recommend using OE because it supports all Amazon accessory buckets in all regions, including opt in regions launched after December 2022. Amazon S3 server side encryption with AWS Kms is ek MS Dynamic Request is post put etcetera to Amazon S3. 
 
 The third option O, EI or origin Access identity is now considered legacy as it doesn't support the previously mentioned scenarios or it requires extra workarounds in those scenarios. 
 
 For this administration, we will use the recommended approach and configure O. Thus, select the radio button origin access control settings from the drop down menu. Select your origin access control settings. If none is created, then select. Create control settings and then click create. Cloudfront will provide you with a bucket policy after creating the distribution, which you will need to manually apply to your necessary bucket to grant cloudfront permissions. We will address this at the end of the current distribution weather. 
 
 Once the distribution is created at the top, a blue ribbon would appear stating that you will need to update the S3 bucket policy. You can click the copy policy button on the right of the ribbon. Thereafter, navigate to the necessary Console, then your accessor bucket. Under permissions, you should find the bucket policy you can then click, edit and then paste in the bucket policy provided to you by CloudFront and then click save changes. You can add a custom header for CloudFront if you want to include it in all requests that it sends to your origin. 
 
 Also, you can activate origin Shield for your distribution if you want. Origin Shield is an additional caching layer that comes with additional costs. By expanding the additional Settings section, you can refine the default values for connection attempts connection time out in addition to the custom origin only related settings such as response time out and keep alive time out. Under the default cache behaviour, you can specify a path pattern to determine the requests that apply to this cache behaviour. Based on the requests you pass, for example, you can apply cache to only GP J images in a specific folder. While excluding dynamic JavaScript. Content from this behaviour note that bath patterns are case sensitive and they support wild card matching. However, the bath pattern doesn't support rejects the compress objects automatically Option is set to us by default. This setting means that cloudfront compresses certain files that it receives from the origin before delivering them to the viewer under the viewer section. Let's select our viewer protocol policy. We have three options HT TB and HTTP S redirect HTTP to https and http S only for our demo. Let's select the second option to make sure that all users are served traffic over https. Choosing the first option allows HTTP traffic and the third option blocks all HTTP requests for allowed HTTP methods You can select the option that applies to your use case. Under restrict viewer access, you can choose to restrict viewer access either by using cloudfront signed U ls or signed cookies to access your content under the cache key and origin requests. It is best practise to use a cash policy and the origin request policy to control the cache key and the origin requests. You can also choose to use an existing response, header policy or create a new one. You can associate edgy functions and cloudfront events with this cache behaviour under settings for the price class for best performance, it is the best practise to use all edge locations. 
 
 You can optionally associate a WAF firewall cl with your distribution next. Depending on your use case, you can add an alternate domain name or cname or a list of them. If you don't use a custom domain name, Cloudfront assigns a default domain name to your distribution. In this case, you can use the default S SL certificate that is already selected and available in the distribution. If you wanted to use a custom domain name such as WWW dot example .com in state, then you must use a custom S SL certificate that covers the custom domain name that is added to cloudfront. This lets you change the security policy associated to your distribution. 
 
 If you are using your own domain name with cloudfront, follow these additional steps before you create your distribution. Specify your domain name in the alternate domain name section. Note that you must own the domain and have access to make DNS record updates to serve traffic using the domain. Next, configure the custom SSL certificate. Choose custom SSL certificate. 
 
 Under SSL certificates, you can either request a certificate from AWS Certificate Manager or you can import a certificate to be used with cloudfront. Note that the certificate must be in US east. One region to be used with cloudfront. If your certificate is not in the US East one region, then you can't use that certificate with cloudfront. If the certificate is imported, it must be issued by a trusted C A. To request a certificate from ECM, navigate to the ECM Console and then request a certificate. Add a domain name and then choose DNS or email validation to prove the ownership of the domain. When domain ownership validation is complete, the CM certificate is issued. From that point, the certificate can be used with cloudfront by selecting it in the distribution configuration. 
 
 The next step is to update the DNS record to point to the cloudfront distribution signing. Note that you can find your distribution's domain name in the cloudfront Console. Updating the cname record allows content to be served through your custom domain name through cloudfront. You can use Amazon Route53 to create an Elis record. I will show you how to do that. Navigate to the Route53 Console and then choose hosted zones in the hosted zone. Create a hosted zone that is the name of the domain that you wanted to route traffic for. For instance, if you wanted to use example .com enter that here and then you choose to create a hosted zone button. 
 
 After a hosted zone is created, create a record. I will use simple routing. Choose next. Define a simple record for your domain name Here, for example, if your domain name is WWW dot example .com, then enter WWW here. The example .com will be here. Next. Toggle the Elis button on and choose the endpoint that you want to use in this case, ellias to cloudfront distribution. Choose your distribution here. Choose a simple routing policy and then choose the create records button To use your own domain name. You can use Route53 to create an Elis record that points to your CloudFront distribution. An Elis record is a Route53 extension to DNS. It is similar to a cname record, but you can create an S record for both a root domain such as example .com and the subdomain WWW dot example .com. If you are using another DNS provider, you can create a cname record only for sub domains such as WWW dot example .com cloudfront allows you to choose the HT TB version that is supported between the client and the CloudFront. This means that you can add support for http three or two depending on your workflow. Http 1.1 is supported by default. You can activate standard access logging to log requests and errors to an SRE bucket. Doing so can help you troubleshoot issues that might occur later. You can activate or deactivate IP version six support on your distribution. If IP version six is deactivated, then the DNS locked against your distribution. Wants to return IP version six addresses. So now you know how to configure an Amazon cloudfront distribution. To serve HTTP S requests for an Amazon S3 bucket. The main difference is between a website endpoint and a REST P endpoint in Amazon S3 and how to use a custom SSL certificate with your CloudFront distribution. Thank you for watching and happy cloud computing from all of us here at S